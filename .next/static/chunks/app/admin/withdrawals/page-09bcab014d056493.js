(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[114],{50786:function(e,t,a){Promise.resolve().then(a.bind(a,43940))},43940:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var s=a(57437),r=a(2265);function l(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[n,i]=(0,r.useState)("");(0,r.useEffect)(()=>{c()},[]);let c=async()=>{try{let e=await fetch("/api/admin/withdrawals");if(!e.ok)throw Error("Failed to fetch withdrawals");let a=await e.json();t(a.withdrawals)}catch(e){i("Failed to load withdrawals"),console.error(e)}finally{l(!1)}},d=async(e,t,a,s)=>{let r="";if("REJECTED"!==t||(r=prompt("Please provide a reason for rejection:")||"")){if("COMPLETED"===t&&a<s){alert("Insufficient balance to complete this withdrawal");return}try{if(!(await fetch("/api/admin/withdrawals",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({withdrawalId:e,status:t,reason:r})})).ok)throw Error("Failed to update withdrawal status");await c()}catch(e){alert("Failed to update withdrawal status"),console.error(e)}}};if(a)return(0,s.jsx)("div",{className:"p-4",children:"Loading..."});if(n)return(0,s.jsx)("div",{className:"p-4 text-red-500",children:n});let o=e.filter(e=>"PENDING"===e.status),m=e.filter(e=>"PENDING"!==e.status);return(0,s.jsxs)("div",{className:"p-4 max-w-6xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Manage Withdrawals"}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Pending Withdrawals (",o.length,")"]}),(0,s.jsxs)("div",{className:"space-y-6",children:[o.map(e=>(0,s.jsx)("div",{className:"border-b pb-6 last:border-b-0 last:pb-0",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium",children:[e.user.name," (",e.user.email,")"]}),(0,s.jsxs)("p",{className:"text-lg font-semibold text-blue-600",children:["$",e.amount.toFixed(2)," from ",e.account.type]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["To: ",e.bankName," - ",e.accountNumber]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Account Name: ",e.accountName]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Requested: ",new Date(e.createdAt).toLocaleString()]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Current Balance: $",e.account.balance.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsx)("button",{onClick:()=>d(e.id,"APPROVED",e.account.balance,e.amount),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Approve"}),(0,s.jsx)("button",{onClick:()=>d(e.id,"COMPLETED",e.account.balance,e.amount),className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Complete"}),(0,s.jsx)("button",{onClick:()=>d(e.id,"REJECTED",e.account.balance,e.amount),className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Reject"})]})]})},e.id)),0===o.length&&(0,s.jsx)("p",{className:"text-gray-500",children:"No pending withdrawals"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Processed Withdrawals (",m.length,")"]}),(0,s.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,s.jsx)("div",{className:"border-b pb-4 last:border-b-0 last:pb-0",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium",children:[e.user.name," (",e.user.email,")"]}),(0,s.jsxs)("p",{className:"text-lg",children:["$",e.amount.toFixed(2)," from ",e.account.type]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["To: ",e.bankName," - ",e.accountNumber]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded text-sm ".concat("COMPLETED"===e.status?"bg-green-100 text-green-800":"REJECTED"===e.status?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.status}),e.reason&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.reason})]})]})},e.id))})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=50786)}),_N_E=e.O()}]);